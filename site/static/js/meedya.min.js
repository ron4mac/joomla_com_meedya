/*
	Copyright (C) 2022 RJCreations. All rights reserved.
 @license		GNU General Public License version 3 or later; see LICENSE.txt
*/
'use strict';(function(d,z,m){let n,f,u,v,h=0,p,w,k,q;const g=a=>document.getElementById(a),x={vopts:{video:{tpl:'<video class="fancybox-video" controls controlsList="nodownload" poster="{{poster}}" playsinline ><source src="{{src}}" type="{{format}}" />Sorry, your browser does not support embedded videos, <a href="{{src}}">download</a> and watch with your favorite video player!</video>',autoStart:!0}},sopts:{loop:!1,slideShow:{speed:5E3}},ivbuts:{buttons:["zoom","slideShow","fullScreen","download",
"close"]},ssbuts:{buttons:["fullScreen","close"],slideShow:{autoStart:!0}},showSlide:(a,b)=>{a.preventDefault();a=JSON.parse(JSON.stringify(d.items));d.FB4?Fancybox.show(a,{startIndex:b}):m.fancybox.open(a,Object.assign({},this.sopts,this.vopts,this.ivbuts),b)},slideShow:a=>{a.preventDefault();a=JSON.parse(JSON.stringify(d.items));d.FB4?Fancybox.show(a):m.fancybox.open(a,Object.assign({},this.sopts,this.vopts,this.ssbuts))}},A={showSlide:(a,b)=>{a.preventDefault();m("#sstage").appendTo("body").show();
ssCtl.init(d.items,b)}},r=a=>{a.open?a.open():jQuery(a).modal("show")},t=a=>{a.close?a.close():jQuery(a).modal("hide")},B=a=>{const b=new FormData;Object.keys(a).forEach(c=>{"object"!==typeof a[c]?b.append(c,a[c]):b.append(c,JSON.stringify(a[c]))});return b},l=(a,b={},c=null,C=!1,y=null)=>{"object"===typeof b?b instanceof FormData||(b=B(b)):"string"===typeof b&&(b=new URLSearchParams(b));a&&b.set("task",a);fetch(z.rawURL,{method:"POST",body:b}).then(e=>{if(!e.ok)throw Error(`HTTP ${e.status}`);return C?
e.json():e.text()}).then(e=>c&&c(e)).catch(e=>alert("Failure: "+e)).then(()=>y&&y())},D=(a,b)=>{h=a;v=b;l("rateChk",{iid:a},c=>{c?alert(c):r(f)})},E=a=>{h=a;q.innerHTML="";l("getComments",{[n]:1,iid:a},b=>{q.innerHTML=b;r(w)})},F=a=>{(0!==a.detail||confirm("Clear rating for this item?"))&&l("rateItem",{[n]:1,iid:h,val:a.detail},b=>{v.firstElementChild.firstElementChild.style.width=b+"%";u.enable()},!1,()=>t(f))};d.initIV=(a=!1)=>{d.viewer=a?A:x};d.performSearch=a=>{if(""===a.sterm.value.trim())return alert(d.L.no_sterm),
!1;a.submit();return!1};d.thmClick=a=>{var b=a.target;switch(b.className){case "imgthm":a.stopPropagation();x.showSlide(a,+b.parentElement.parentElement.parentElement.dataset.ix);break;case "strating":b=b.parentElement;case "strback":b=b.parentElement;case "strate":a.stopPropagation();if(!f)break;a=+b.parentElement.parentElement.parentElement.parentElement.dataset.iid;D(a,b);break;case "far fa-comments":case "icon-comments-2":b=b.parentElement;case "mycmnts":case "mycmnts hasem":a.stopPropagation(),
h=a=+b.parentElement.parentElement.parentElement.parentElement.dataset.iid,p=b,b.classList.contains("hasem")?E(a):(g("cmnt-text").value="",r(k))}};d.submitComment=a=>{a.disabled=!0;let b=new FormData(newcmnt);b.append("iid",h);l(null,b,c=>{t(k);a.disabled=!1;p.classList.add("hasem");p.innerHTML=c})};d.sprintf=a=>{for(var b=1;b<arguments.length;b++)a=a.replace(/%s/,arguments[b]);return a};document.addEventListener("DOMContentLoaded",()=>{n=Joomla.getOptions("csrf.token","");if(f=g("rating-modal")){f.addEventListener("hidden.bs.modal",
b=>{t(f)});var a=g("unrating");u=new SimpleStarRating(a);a.addEventListener("rate",F)}(w=g("comments-modal"))&&(q=document.querySelector(".modal-body .comments"));(k=g("comment-modal"))&&k.addEventListener("shown.bs.modal",b=>{g("cmnt-text").focus()})})})(window.Meedya=window.Meedya||{},Joomla.getOptions("Meedya"),jQuery);