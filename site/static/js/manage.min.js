/*
	Copyright (C) 2022 RJCreations. All rights reserved.
 @license		GNU General Public License version 3 or later; see LICENSE.txt
*/
'use strict';const _id=c=>document.getElementById(c),_pd=(c,l=!0)=>{c.preventDefault&&c.preventDefault();l&&c.stopPropagation&&c.stopPropagation()},_ae=(c,l,m,p=!1)=>{c.addEventListener(l,m,p)},_T=c=>Joomla.Text._(c);
(function(c,l,m,p){const k=Joomla.getOptions("csrf.token"),h=a=>{if(!(0>a.dataTransfer.types.indexOf("imgsrc")))return _pd(a),!1},q=a=>{_pd(a);let b=a.dataTransfer.getData("imgsrc");if(b){let d=a.target.parentElement.getElementsByTagName("IMG")[0];d.src=b;d.style.opacity=null;_id("albthmid").value=a.dataTransfer.getData("meeid")}},r=(a,b=!1)=>{if(document.querySelectorAll(a).length)return!0;b&&bootbox.alert(_T("COM_MEEDYA_SELECT_SOME"));return!1},y=a=>{const b=new FormData;Object.keys(a).forEach(d=>
{"object"!==typeof a[d]?b.append(d,a[d]):b.append(d,JSON.stringify(a[d]))});return b},f=(a,b={},d=null,e=!1,t=null)=>{"object"===typeof b?b instanceof FormData||(b=y(b)):"string"===typeof b&&(b=new URLSearchParams(b));a&&b.set("task",a);fetch(l.rawURL,{method:"POST",body:b}).then(g=>{if(!g.ok)throw Error(`HTTP ${g.status}`);return e?g.json():g.text()}).then(g=>d&&d(g)).catch(g=>alert("Failure: "+g)).then(()=>t&&t())};c.postAction=f;let w=null;c.confirm=(a,b,d,e)=>{m("#"+a+" .modal-title").html(b);
m("#"+a+" .modal-body").html(d);w=e;m("#"+a).modal("show")};c.confirmed=a=>w(a);c.alert=a=>{m("#alert-dlg span").html(a);m("#alert-dlg").show()};c.setAlbumDanD=()=>{var a=_id("albthm");_ae(a,"dragover",h);_ae(a,"drop",q);_ae(a,"dragenter",b=>{_pd(b);b.target.style.opacity="0.5"});_ae(a,"dragleave",b=>b.target.style.opacity=null);a=_id("albForm");_ae(a,"dragstart",b=>b.dataTransfer.setData("albthm","X"));_ae(a,"dragover",b=>{0<b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect=
"move")});_ae(a,"dragenter",b=>{0<b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect="move")});_ae(a,"drop",b=>{_pd(b);_id("albthmimg").src="components/com_meedya/static/img/img.png";_id("albthmid").value=0})};c.deleteSelected=a=>{_pd(a);r("[name='slctimg[]']:checked",!0)&&bootbox.confirm({message:_T("COM_MEEDYA_PERM_DELETE"),buttons:{confirm:{label:_T("JACTION_DELETE"),className:"btn-danger"},cancel:{label:_T("JCANCEL")}},callback:b=>{b&&(document.adminForm.task.value="manage.deleteItems",
document.adminForm.submit())}})};c.removeSelected=a=>{_pd(a);r("[name='slctimg[]']:checked",!0)&&bootbox.confirm({message:_T("COM_MEEDYA_REMOVE"),buttons:{confirm:{label:_T("COM_MEEDYA_VRB_REMOVE"),className:"btn-danger"},cancel:{label:_T("JCANCEL")}},callback:b=>{if(b){b=document.querySelectorAll("[name='slctimg[]']:checked");let d=b[0].parentNode.parentNode;for(let e=0;e<b.length;e++)d.removeChild(b[e].parentNode);z=!0}}})};c.selAllImg=(a,b)=>{_pd(a);a=b?"checked":"";b=document.adminForm.elements["slctimg[]"];
b.length||(b=[b]);for(let d=0;d<b.length;d++)b[d].checked=a};c.editSelected=a=>{_pd(a);r("input[name='slctimg[]']:checked",!0)&&(document.adminForm.task.value="manage.imgsEdit",document.adminForm.submit())};c.addSelected=a=>{_pd(a);r("input[name='slctimg[]']:checked",!0)&&(a=_id("add2albdlg"),a.open?a.open():jQuery(a).modal("show"))};c.albAction=a=>{let b=a.target;switch(b.className){case "icon-edit":_pd(a);window.location=l.aURL+"manage.editAlbum&aid="+b.parentElement.dataset.aid;break;case "icon-upload":_pd(a);
window.location=l.aURL+"manage.doUpload&aid="+b.parentElement.dataset.aid;break;case "icon-delete":_pd(a);c.alb2delete=b.parentElement.dataset.aid;a=_id("delact");a.open?a.open():jQuery(a).modal("show");break;case "album":c.AArrange.iSelect(a,b)}};c.saveAlbum=()=>{z&&(document.albForm.thmord.value=c.Arrange.iord());document.albForm.submit()};c.deleteAlbum=a=>{a=document.forms.dalbform;a.aid.value=c.alb2delete;a.submit()};c.watchAlb=a=>{let b=_id("creab");0<a.value?(_id("creanualb").style.display=
"none",b.disabled=!1):(b.disabled=!0,-1==a.value?_id("creanualb").style.display="block":_id("creanualb").style.display="none")};c.watchAlbNam=a=>{let b=_id("creab");a.value.trim()?b.disabled=!1:b.disabled=!0};c.addItems2Album=a=>{a.disabled=!0;document.adminForm.albumid.value=_id("h5u_album").value;document.adminForm.nualbnam.value=_id("nualbnam").value;document.adminForm.nualbpar.value=_id("h5u_palbum").value;document.adminForm.nualbdesc.value=_id("albdesc").value;document.adminForm.task.value="manage.addItemsToAlbum";
document.adminForm.submit()};c.ae_createAlbum=a=>{a.disabled=!0;a=_id("nualbnam");let b=_id("h5u_palbum"),d=_id("albdesc");a={task:"manage.newAlbum",albnam:a.value.trim(),paralb:b?b.value:0,albdesc:d.value};a[k]=1;f(null,a,e=>{e?alert(e):p.location.reload(!0)})};let n=null;c.moveItem=(a,b)=>{_pd(a,!0);a=b.parentElement;if(n){n.classList.remove("moving");if(a!=n){b=_id("area");let d=b.removeChild(n);b.insertBefore(d,a)}n=null}else n=a,a.classList.add("moving")};c.setVideoThumb=(a,b)=>{_pd(a,!0);a=
document.getElementById("my-video-canvas");let d=a.getContext("2d"),e=document.querySelector("#zoom-zvid"),t=document.getElementById("my-vidover"),g=0,u=e.videoWidth,x=e.videoHeight,v=0,A=0,B=t.width,C=t.height;e?(0<b?(v=160,A=Math.min(x/v,u/160),u=Math.round(160*A),x=Math.round(v*A),g=0<e.videoWidth-u?e.videoWidth-u>>1:0):v=Math.round(160/(u/x)),a.width=160,a.height=v,d.drawImage(e,g,0,u,x,0,0,160,v),d.drawImage(t,0,0,B,C,3,3,B,C),a=a.toDataURL("image/jpeg",.8),b={task:"manage.setVideoThumb",vid:b,
imgBase64:a},b[k]=1,f(null,b,D=>{c.thmelmsrc.src=D;iZoomClose()})):alert("Did not locate the video.")};let z=!1;c.dirtyThumbs=a=>{z=a}})(window.Meedya=window.Meedya||{},Joomla.getOptions("Meedya"),jQuery,window);
(function(c,l,m,p){let k,h,q=f=>{f&&_pd(f);document.body.removeChild(k)},r=f=>{switch(f.charCode){case 32:case 13:case 27:q(f)}},y=f=>{switch(f.keyCode){case 32:case 13:case 27:q(f)}};p.iZoomOpen=(f,w)=>{w&&(c.thmelmsrc=w.parentElement.previousElementSibling.firstElementChild);h=document.createElement("div");c.postAction("manage.getZoomItem",{iid:f},n=>{h.innerHTML=n});h.className="zoom-area";h.tabIndex="-1";k=document.createElement("div");k.className="zoom-back";k.appendChild(h);document.body.appendChild(k);
_ae(h,"keypress",r);_ae(h,"keydown",y);h.focus();_ae(k,"click",q)};p.iZoomClose=q})(Meedya,Joomla.getOptions("Meedya"),jQuery,window);