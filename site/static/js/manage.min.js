"undefined"===typeof Meedya&&(Meedya={});function _id(g){return document.getElementById(g)}function _pd(g,k){k=void 0===k?!0:k;g.preventDefault&&g.preventDefault();k&&g.stopPropagation&&g.stopPropagation()}function _ae(g,k,r,n){g.addEventListener(k,r,void 0===n?!1:n)}
(function(g){function k(c){if(!(0>c.dataTransfer.types.indexOf("imgsrc")))return _pd(c),c.dataTransfer.dropEffect="copy",!1}function r(c){_pd(c);var b=c.dataTransfer.getData("imgsrc");b&&(this.getElementsByTagName("IMG")[0].src=b,_id("albthmid").value=c.dataTransfer.getData("meeid"));this.style.opacity="1.0"}function n(c,b){b=void 0===b?!1:b;if(document.querySelectorAll(c).length)return!0;b&&bootbox.alert(Joomla.JText._("COM_MEEDYA_SELECT_SOME"));return!1}Meedya.setDlgParAlb=function(){_id("h5u_palbum")&&
(_id("h5u_palbum").value=Meedya.AArrange.selalb())};Meedya.setAlbumDanD=function(){var c=_id("albthm");_ae(c,"dragover",k,!1);_ae(c,"drop",r,!1);_ae(c,"dragenter",function(){this.style.opacity="0.5"},!1);_ae(c,"dragleave",function(){this.style.opacity="1.0"},!1);c=_id("albForm");_ae(c,"dragstart",function(b){b.dataTransfer.setData("albthm","X")},!1);_ae(c,"dragover",function(b){0<b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect="move")},!1);_ae(c,"dragenter",function(b){0<
b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect="move")},!1);_ae(c,"drop",function(b){_pd(b);_id("albthmimg").src="components/com_meedya/static/img/img.png";_id("albthmid").value=0},!1)};Meedya.deleteSelected=function(c){_pd(c);n("[name='slctimg[]']:checked",!0)&&bootbox.confirm({message:Joomla.JText._("COM_MEEDYA_PERM_DELETE"),buttons:{confirm:{label:"JACTION_DELETE",className:"btn-danger"},cancel:{label:"JCANCEL"}},callback:function(b){b&&(document.adminForm.task.value=
"manage.deleteItems",document.adminForm.submit())}})};Meedya.removeSelected=function(c){_pd(c);n("[name='slctimg[]']:checked",!0)&&bootbox.confirm({message:Joomla.JText._("COM_MEEDYA_REMOVE"),buttons:{confirm:{label:"COM_MEEDYA_VRB_REMOVE",className:"btn-danger"},cancel:{label:"JCANCEL"}},callback:function(b){if(b){b=document.querySelectorAll("[name='slctimg[]']:checked");for(var d=b[0].parentNode.parentNode,h=0;h<b.length;h++)d.removeChild(b[h].parentNode)}}})};Meedya.selAllImg=function(c,b){_pd(c);
var d=b?"checked":"",h=document.adminForm.elements["slctimg[]"];h.length||(h=[h]);for(var p=0;p<h.length;p++)h[p].checked=d};Meedya.editSelected=function(c){_pd(c);n("input[name='slctimg[]']:checked",!0)&&(document.adminForm.task.value="manage.imgsEdit",document.adminForm.submit())};Meedya.addSelected=function(c){_pd(c);n("input[name='slctimg[]']:checked",!0)&&g("#add2albdlg").modal("show")};Meedya.saveAlbum=function(){document.albForm.thmord.value=Meedya.Arrange.iord();document.albForm.submit()};
Meedya.watchAlb=function(c){var b=_id("creab"),d=b.classList;0<c.value?(_id("creanualb").style.display="none",d.remove("btn-disabled"),d.add("btn-primary"),b.disabled=!1):(d.remove("btn-primary"),d.add("btn-disabled"),b.disabled=!0,-1==c.value?_id("creanualb").style.display="block":_id("creanualb").style.display="none")};Meedya.watchAlbNam=function(c){var b=_id("creab"),d=b.classList;c.value.trim()?(d.remove("btn-disabled"),d.add("btn-primary"),b.disabled=!1):(d.remove("btn-primary"),d.add("btn-disabled"),
b.disabled=!0)};Meedya.addItems2Album=function(c){c.disabled=!0;document.adminForm.albumid.value=_id("h5u_album").value;document.adminForm.nualbnam.value=_id("nualbnam").value;document.adminForm.nualbpar.value=_id("h5u_palbum").value;document.adminForm.nualbdesc.value=_id("albdesc").value;document.adminForm.task.value="manage.addItemsToAlbum";document.adminForm.submit()};Meedya.aj_addItems2Album=function(c){c.disabled=!0;var b=_id("nualbnam"),d=_id("h5u_palbum"),h=_id("albdesc");b={task:"manage.addItemsToAlbum",
albnam:b.value.trim(),paralb:d?d.value:0,albdesc:h.value};b[Meedya.formTokn]=1;g.post(Meedya.rawURL,b,function(p,t,m){"success"==t?p?alert(p):window.location.reload(!0):alert(m.statusText);c.disabled=!1})};Meedya.ae_createAlbum=function(c){c.disabled=!0;var b=_id("nualbnam"),d=_id("h5u_palbum"),h=_id("albdesc");b={task:"manage.newAlbum",albnam:b.value.trim(),paralb:d?d.value:0,albdesc:h.value};b[Meedya.formTokn]=1;g.post(Meedya.rawURL,b,function(p,t,m){"success"==t?(jQuery("#newalbdlg").modal("hide"),
p?alert(p):window.location.reload(!0)):alert(m.statusText);c.disabled=!1})};var l=null;Meedya.moveItem=function(c){c=c.parentElement;console.log(c);if(l){l.classList.remove("moving");if(c!=l){var b=_id("area"),d=b.removeChild(l);b.insertBefore(d,c)}l=null}else l=c,c.classList.add("moving")}})(jQuery);
Meedya.Arrange=function(g){function k(a){a=a.dataTransfer.types;for(var e=0;e<a.length;++e)if("meeid"===a[e])return!0;return!1}function r(a){this.style.opacity="0.4";t=this;a.dataTransfer.effectAllowed="move";a.dataTransfer.setData("meeid",this.getAttribute("data-id"));a.dataTransfer.setData("imgsrc",this.getElementsByTagName("IMG")[0].src)}function n(a){if(k(a))return _pd(a),a.dataTransfer.dropEffect="move",!1}function l(a){if(k(a))return _pd(a),this.classList.add("over"),!1}function c(a){this.classList.remove("over")}
function b(a){_pd(a);if(t!=this){a=_id(q);var e=a.removeChild(t);a.insertBefore(e,this)}return!1}function d(a){this.style.opacity=null;[].forEach.call(u,function(e){e.classList.remove("over")});m=!0}function h(a){m=!0;50>a.clientY&&(m=!1,w(-1));a.clientY>g(window).height()-50&&(m=!1,w(1))}function p(a){1==a.targetTouches.length&&(a=a.targetTouches[0],this.style.left=a.pageX+"px",this.style.top=a.pageY+"px")}var t=null,m=!0,q="",v="",u,w=function(a){var e=g(window).scrollTop();g(window).scrollTop(e+
a);m||setTimeout(function(){w(a)},60)};return{init:function(a,e){q=a;v=e;u=document.querySelectorAll("#"+a+" ."+e);[].forEach.call(u,function(f){_ae(f,"drag",h);_ae(f,"dragstart",r);_ae(f,"dragenter",l);_ae(f,"dragover",n);_ae(f,"dragleave",c);_ae(f,"drop",b);_ae(f,"dragend",d);_ae(f,"touchmove",p)})},iord:function(){u=document.querySelectorAll("#"+q+" ."+v);var a=[];[].forEach.call(u,function(e){(e=e.getAttribute("data-id"))&&a.push(e)});return a.join("|")}}}(jQuery);
Meedya.AArrange=function(g){function k(a,e,f){a={task:"manage.adjustAlbPaid",aid:a,paid:e};a[Joomla.getOptions("csrf.token","")]=1;g.post(Meedya.rawURL,a,function(x){f(x)})}function r(a){a.target.style.opacity="0.4";m=this;a.dataTransfer.effectAllowed="copyMove";a.dataTransfer.setData("meeid",this.getAttribute("data-id"))}function n(a){a:{var e=a.dataTransfer.types;for(var f=0;f<e.length;++f)if("meeid"===e[f]){e=!0;break a}e=!1}if(e)return _pd(a),a.dataTransfer.dropEffect="move",!1}function l(a){_pd(a);
this.classList.add("over");return!1}function c(a){_pd(a);this.classList.remove("over")}function b(a){_pd(a);m!=this&&(sa=m.getAttribute("data-aid"),da=a.target.getAttribute("data-aid"),k(sa,da,function(e){e?bootbox.alert(Joomla.JText._("COM_MEEDYA_MOVE_FAIL")):a.target.append(m)}));return!1}function d(a){this.style.opacity="1.0";[].forEach.call(u,function(e){e.classList.remove("over")});v=!0}function h(a){v=!0;50>a.clientY&&(v=!1,w(-1));a.clientY>g(window).height()-50&&(v=!1,w(1))}function p(a){1==
a.targetTouches.length&&(a=a.targetTouches[0],this.style.left=a.pageX+"px",this.style.top=a.pageY+"px")}function t(a){_pd(a);q&&q.classList.remove("slctd");this==q?q=null:(q=this,q.classList.add("slctd"))}var m=null,q=null,v=!0,u,w=function(a){var e=g(window).scrollTop();g(window).scrollTop(e+a);v||setTimeout(function(){w(a)},500)};return{init:function(a,e){u=document.querySelectorAll("#"+a+" ."+e);[].forEach.call(u,function(f){_ae(f,"drag",h);_ae(f,"dragstart",r,!0);_ae(f,"dragenter",l);_ae(f,"dragover",
n);_ae(f,"dragleave",c);_ae(f,"drop",b);_ae(f,"dragend",d);_ae(f,"touchmove",p);_ae(f,"click",t)})},selalb:function(){return q?q.getAttribute("data-aid"):0}}}(jQuery);
(function(g,k){function r(d){switch(d.charCode){case 32:case 13:case 27:l(d)}}function n(d){switch(d.keyCode){case 32:case 13:case 27:l(d)}}function l(d){_pd(d);document.body.removeChild(c)}var c,b;k.iZoomOpen=function(d){b=document.createElement("div");g.post(Meedya.rawURL,{task:"manage.getZoomItem",iid:d},function(h){b.innerHTML=h});b.className="zoom-area";b.tabIndex="-1";c=document.createElement("div");c.className="zoom-back";c.appendChild(b);document.body.appendChild(c);_ae(b,"keypress",r,!1);
_ae(b,"keydown",n,!1);b.focus();_ae(c,"click",l,!1)};k.iZoomClose=l})(jQuery,window);