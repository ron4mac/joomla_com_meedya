'use strict';const _id=n=>document.getElementById(n),_pd=(n,g=!0)=>{n.preventDefault&&n.preventDefault();g&&n.stopPropagation&&n.stopPropagation()},_ae=(n,g,m,f=!1)=>{n.addEventListener(g,m,f)};
var Meedya=function(n,g,m){const f=Joomla.getOptions("csrf.token");let h=a=>{if(!(0>a.dataTransfer.types.indexOf("imgsrc")))return _pd(a),!1},u=a=>{_pd(a);let b=a.dataTransfer.getData("imgsrc");if(b){let l=a.target.parentElement.getElementsByTagName("IMG")[0];l.src=b;l.style.opacity=null;_id("albthmid").value=a.dataTransfer.getData("meeid")}},v=(a,b=!1)=>{if(document.querySelectorAll(a).length)return!0;b&&bootbox.alert(Joomla.Text._("COM_MEEDYA_SELECT_SOME"));return!1},q=null;return{setDlgParAlb:()=>
{_id("h5u_palbum")&&(_id("h5u_palbum").value=Meedya.AArrange.selalb())},selAllImg:(a,b)=>{_pd(a);a=b?"checked":"";b=document.adminForm.elements["slctimg[]"];b.length||(b=[b]);for(let l=0;l<b.length;l++)b[l].checked=a},editSelected:a=>{_pd(a);v("input[name='slctimg[]']:checked",!0)&&(document.adminForm.task.value="manage.imgsEdit",document.adminForm.submit())},addSelected:a=>{_pd(a);v("input[name='slctimg[]']:checked",!0)&&g("#add2albdlg").modal("show")},removeSelected:a=>{_pd(a);v("[name='slctimg[]']:checked",
!0)&&bootbox.confirm({message:Joomla.Text._("COM_MEEDYA_REMOVE"),buttons:{confirm:{label:Joomla.Text._("COM_MEEDYA_VRB_REMOVE"),className:"btn-danger"},cancel:{label:Joomla.Text._("JCANCEL")}},callback:b=>{if(b){b=document.querySelectorAll("[name='slctimg[]']:checked");let l=b[0].parentNode.parentNode;for(let p=0;p<b.length;p++)l.removeChild(b[p].parentNode)}}})},deleteSelected:a=>{_pd(a);v("[name='slctimg[]']:checked",!0)&&bootbox.confirm({message:Joomla.Text._("COM_MEEDYA_PERM_DELETE"),buttons:{confirm:{label:Joomla.Text._("JACTION_DELETE"),
className:"btn-danger"},cancel:{label:Joomla.Text._("JCANCEL")}},callback:b=>{b&&(document.adminForm.task.value="manage.deleteItems",document.adminForm.submit())}})},setAlbumDanD:()=>{var a=_id("albthm");_ae(a,"dragover",h);_ae(a,"drop",u);_ae(a,"dragenter",b=>{_pd(b);b.target.style.opacity="0.5"});_ae(a,"dragleave",b=>b.target.style.opacity=null);a=_id("albForm");_ae(a,"dragstart",b=>b.dataTransfer.setData("albthm","X"));_ae(a,"dragover",b=>{0<b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect=
"move")});_ae(a,"dragenter",b=>{0<b.dataTransfer.types.indexOf("albthm")&&(_pd(b),b.dataTransfer.dropEffect="move")});_ae(a,"drop",b=>{_pd(b);_id("albthmimg").src="components/com_meedya/static/img/img.png";_id("albthmid").value=0})},saveAlbum:()=>{document.albForm.thmord.value=Meedya.Arrange.iord();document.albForm.submit()},watchAlb:a=>{let b=_id("creab");0<a.value?(_id("creanualb").style.display="none",b.disabled=!1):(b.disabled=!0,-1==a.value?_id("creanualb").style.display="block":_id("creanualb").style.display=
"none")},watchAlbNam:a=>{let b=_id("creab");a.value.trim()?b.disabled=!1:b.disabled=!0},addItems2Album:a=>{a.disabled=!0;document.adminForm.albumid.value=_id("h5u_album").value;document.adminForm.nualbnam.value=_id("nualbnam").value;document.adminForm.nualbpar.value=_id("h5u_palbum").value;document.adminForm.nualbdesc.value=_id("albdesc").value;document.adminForm.task.value="manage.addItemsToAlbum";document.adminForm.submit()},ae_createAlbum:a=>{a.disabled=!0;a=_id("nualbnam");let b=_id("h5u_palbum"),
l=_id("albdesc");a={task:"manage.newAlbum",albnam:a.value.trim(),paralb:b?b.value:0,albdesc:l.value};a[f]=1;g.post(n.rawURL,a).done(p=>{p?alert(p):m.location.reload(!0)}).fail(p=>alert(p.responseText))},moveItem:(a,b)=>{_pd(a,!0);a=b.parentElement;if(q){q.classList.remove("moving");if(a!=q){b=_id("area");let l=b.removeChild(q);b.insertBefore(l,a)}q=null}else q=a,a.classList.add("moving")},setVideoThumb:(a,b)=>{_pd(a,!0);a=document.getElementById("my-video-canvas");let l=a.getContext("2d"),p=document.querySelector("#zoom-zvid"),
w=document.getElementById("my-vidover"),y=0,t=p.videoWidth,d=p.videoHeight,e=0,c=0,k=w.width,r=w.height;p?(0<b?(e=160,c=Math.min(d/e,t/160),t=Math.round(160*c),d=Math.round(e*c),y=0<p.videoWidth-t?p.videoWidth-t>>1:0):e=Math.round(160/(t/d)),a.width=160,a.height=e,l.drawImage(p,y,0,t,d,0,0,160,e),l.drawImage(w,0,0,k,r,3,3,k,r),a=a.toDataURL("image/jpeg",.8),b={task:"manage.setVideoThumb",vid:b,imgBase64:a},b[Joomla.getOptions("csrf.token","")]=1,g.post(n.rawURL,b).done(x=>{Meedya.thmelmsrc.src=x;
iZoomClose()}).fail(x=>alert(x.responseText))):alert("Did not locate the video.")}}}(Joomla.getOptions("Meedya"),jQuery,window);
Meedya.Arrange=function(n){let g=null,m=!0,f="",h,u=d=>{if(d.target.parentElement.parentElement==g)return!1;d=d.dataTransfer.types;for(let e=0;e<d.length;++e)if("meeid"===d[e])return!0;return!1},v=d=>{g=d.target.parentElement.parentElement;g.style.opacity="0.4";d.dataTransfer.effectAllowed="copyMove";d.dataTransfer.setData("meeid",g.getAttribute("data-id"));d.dataTransfer.setData("imgsrc",d.target.src)},q=d=>{m=!0;50>d.clientY&&(m=!1,t(-1));d.clientY>n(window).height()-50&&(m=!1,t(1))},a=d=>{if(1==
d.targetTouches.length){let e=d.targetTouches[0];d.target.style.left=e.pageX+"px";d.target.style.top=e.pageY+"px"}},b=d=>{g.style.opacity=null;[].forEach.call(h,e=>e.classList.remove("over"));m=!0},l=d=>{_pd(d);d=d.target.parentElement.parentElement;if(g!=d){let e=_id(f),c=e.removeChild(g);e.insertBefore(c,d)}return!1},p=d=>{if(u(d))return _pd(d),d.target.classList.add("over"),!1},w=d=>{if(u(d))return _pd(d),!1},y=d=>{d.target.classList.remove("over")};const t=d=>{let e=n(window).scrollTop();n(window).scrollTop(e+
d);m||setTimeout(()=>t(d),60)};return{init:(d,e)=>{f=d;h=document.querySelectorAll("#"+d+" img");[].forEach.call(h,c=>{_ae(c,"drag",q);_ae(c,"dragstart",v);_ae(c,"dragenter",p);_ae(c,"dragover",w);_ae(c,"dragleave",y);_ae(c,"drop",l);_ae(c,"dragend",b);_ae(c,"touchmove",a)})},iord:()=>{h=document.querySelectorAll("#"+f+" img");let d=[];[].forEach.call(h,e=>{(e=e.getAttribute("data-id"))&&d.push(e)});return d.join("|")}}}(jQuery);
Meedya.AArrange=function(n,g){let m=null,f=null,h=!0,u,v=(c,k,r)=>{c={task:"manage.adjustAlbPaid",aid:c,paid:k};c[Joomla.getOptions("csrf.token","")]=1;g.post(n.rawURL,c,x=>r(x))},q=c=>{if(c.target==m)return!1;c=c.dataTransfer.types;for(let k=0;k<c.length;++k)if("meeid"===c[k])return!0;return!1},a=c=>{c.target.style.opacity="0.4";m=c.target;c.dataTransfer.effectAllowed="copyMove";c.dataTransfer.setData("meeid",m.getAttribute("data-id"));c.target.classList.add("moving")},b=c=>{if(q(c))return _pd(c),
!1},l=c=>{if(q(c))return _pd(c),c.target.classList.add("over"),!1},p=c=>{_pd(c);c.target.classList.remove("over")},w=c=>{_pd(c);if(m!=c.target){let k=m.getAttribute("data-aid"),r=c.target.getAttribute("data-aid");v(k,r,x=>{x?bootbox.alert(Joomla.Text._("COM_MEEDYA_MOVE_FAIL")):c.target.append(m)})}return!1},y=c=>{m.style.opacity=null;[].forEach.call(u,k=>k.classList.remove("over"));c.target.classList.remove("moving");h=!0},t=c=>{h=!0;50>c.clientY&&(h=!1,e(-1));c.clientY>g(window).height()-50&&(h=
!1,e(1))},d=c=>{if(1==c.targetTouches.length){let k=c.targetTouches[0];c.target.style.left=k.pageX+"px";c.target.style.top=k.pageY+"px"}};const e=c=>{let k=g(window).scrollTop();g(window).scrollTop(k+c);h||setTimeout(()=>e(c),500)};return{init:(c,k)=>{u=document.querySelectorAll("#"+c+" ."+k);[].forEach.call(u,r=>{r.setAttribute("draggable","true");_ae(r,"drag",t);_ae(r,"dragstart",a,!0);_ae(r,"dragenter",l);_ae(r,"dragover",b);_ae(r,"dragleave",p);_ae(r,"drop",w);_ae(r,"dragend",y);_ae(r,"touchmove",
d)})},selalb:()=>f?f.getAttribute("data-aid"):0,iSelect:(c,k=this)=>{_pd(c);f&&f.classList.remove("slctd");k==f?f=null:(f=k,f.classList.add("slctd"))}}}(Joomla.getOptions("Meedya"),jQuery);
(function(n,g,m){let f,h,u=a=>{switch(a.charCode){case 32:case 13:case 27:q(a)}},v=a=>{switch(a.keyCode){case 32:case 13:case 27:q(a)}},q=a=>{a&&_pd(a);document.body.removeChild(f)};m.iZoomOpen=(a,b)=>{b&&(Meedya.thmelmsrc=b.parentElement.previousElementSibling.firstElementChild);h=document.createElement("div");g.post(n.rawURL,{task:"manage.getZoomItem",iid:a}).done(l=>h.innerHTML=l);h.className="zoom-area";h.tabIndex="-1";f=document.createElement("div");f.className="zoom-back";f.appendChild(h);document.body.appendChild(f);
_ae(h,"keypress",u);_ae(h,"keydown",v);h.focus();_ae(f,"click",q)};m.iZoomClose=q})(Joomla.getOptions("Meedya"),jQuery,window);