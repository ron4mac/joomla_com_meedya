function $id(f){return document.getElementById(f)}function $ae(f,L,A){f.addEventListener(L,A,!1)}
(function(f,L,A){function m(b,a,c){b=document.createElement(b,c);a&&(b.innerHTML=a);for(var g in c)b.setAttribute(g,c[g]);return b}function B(b){b.stopPropagation();b.preventDefault();b.target.className="dragover"==b.type?"hover":"dropzone"}function C(b){var a,c;b instanceof FileList||(B(b),b=b.target.files||b.dataTransfer.files);D&&(D=E=F=0);for(a=0;c=b[a];a++)E+=c.size,h.push(c),v.innerHTML=h.length,w(!1,"fsel");h.length>x&&(p.style.display="inline-block")}function M(){if(!q){D=1;if("function"==
typeof e.doneFunc){var b=G,a=H;setTimeout(function(){e.doneFunc(b,a)},1E3)}H=G=0}}function w(b,a){b&&("ufo"==a&&G++,--r||M());if(!q&&h.length&&(!x||r<x)){var c=h.shift();new Q(c);r++;v.innerHTML=h.length}0>=h.length&&(p.style.display="none",t.style.display="none")}function R(b,a){var c=this;c.show=function(l){c.pb.style.width=100*l+"%";1===l&&(c.pb.className="indeterm")};c.msg=function(l,u){c.pbi.innerHTML+="<br />"+l;u&&(c.pbi.className="pbfinf failure",H++)};c.remove=function(){c.pbw._ufo=null;
I.removeChild(c.pbw);c.fObj=null};var g=m("div","",{"class":"pbwrp"});c.pb=g.appendChild(m("div","",{"class":a}));c.pbi=g.appendChild(m("div",b.fileName+'<i class="fa fa-window-close abortX" aria-hidden="true" onclick="this.parentNode.parentNode._ufo.abort(true);"></i>',{"class":"pbfinf"}));I.appendChild(g);c.pbw=g;c.pbw._ufo=b;c.fObj=b;return this}function y(b){!J||0>b||(F+=b,J.style.width=100*F/E+"%")}function k(b,a){for(var c in a)b.append(c,a[c])}function Q(b){var a=this;a.upFile=b;a.fileName=
b.fileName||b.name;a.size=b.fileSize||b.size;a.fType=b.fileType||b.type;a.date=b.lastModified;a.upState="";a.doChnk=a.size>N;a.chnkSize=Math.round(N/2)-3072;a.relPath=b.webkitRelativePath||a.fileName;a.uniqueId=a.size+"-"+Math.random().toString().replace("0.","");a.actSize=0;a.startByte=0;a.lastsz=0;a.numChnks=Math.max(Math.floor(a.size/a.chnkSize),1);a.chnkNum=0;a.fData=null;a.palod=e.payload();b={};a.upForm=(b.task="manage.upfile",b[e.frmtkn]=1,b);a.xhr=new XMLHttpRequest;var c=function(d){a.xhr&&
(a.xhr.upload.onprogress=null,a.xhr.onabort=null,a.xhr.onerror=null,a.xhr.onload=null,a.xhr=null);a.fData=null;d&&a.pBar&&(a.pBar.remove(),a.pBar=null);w(!0,"ufo")},g=function(d){d=void 0===d?!0:d;a.fData=new FormData;k(a.fData,a.upForm);d&&k(a.fData,a.palod)},l=function(){g();switch(a.upState){case "":k(a.fData,{type:a.fType,size:a.size,lastMod:a.date});a.fData.append("Filedata",a.upFile);a.upState="upld";break;case "upld":c(!0);return}a.xhr.open("POST",e.upURL);a.xhr.send(a.fData)},u=function(){g(!1);
switch(a.upState){case "":k(a.fData,{chunkact:"pref",file:a.fileName,type:a.fType,size:a.size,ident:a.uniqueId});a.upState="chnk";break;case "chnk":k(a.fData,{chunkact:"chnk",ident:a.uniqueId,tchnk:a.numChnks});if(a.chnkNum==a.numChnks){c(!0);return}a.startByte=a.chnkNum*a.chnkSize;a.endByte=Math.min(a.size,(a.chnkNum+1)*a.chnkSize);a.size-a.endByte<a.chnkSize&&(a.endByte=a.size);a.actSize=a.endByte-a.startByte;a.fData.append("chnkn",++a.chnkNum);a.chnkNum==a.numChnks&&(k(a.fData,{fname:a.fileName,
type:a.fType,size:a.size,lastMod:a.date}),k(a.fData,a.palod));a.fData.append("Filedata",a.upFile[O](a.startByte,a.endByte));a.lastsz=0;break;case "abrt":a.xhr.timeout=1E4;k(a.fData,{chunkact:"abrt",ident:a.uniqueId});a.upState="nil";break;case "nil":c();return}a.xhr.open("POST",e.upURL);a.xhr.send(a.fData)},z={prog:function(d){if(d.lengthComputable){var n=Math.round(d.loaded/d.total*a.actSize);"chnk"==a.upState&&a.chnkNum?(a.pBar.show((a.startByte+n)/a.size),y(n-a.lastsz),a.lastsz=n):"upld"==a.upState&&
(a.pBar.show(d.loaded/d.total),n=Math.round(d.loaded/d.total*a.size),y(n-a.lastsz),a.lastsz=n)}},chng:function(d){if(!(4>this.readyState))if(200!==this.status)y(a.size-a.startByte-a.lastsz),a.lastsz=a.size,0===this.status?(a.pBar.msg("-- Aborted",!0),a.doChnk?(a.upState="abrt",u()):c()):(a.pBar.msg(this.responseText||this.statusText||this.status,!0),c());else if(200===this.status){if(this.responseText.length)if(":"==this.responseText.charAt())e.success(this.responseText.substr(1));else{a.pBar.msg(this.responseText,
!0);return}a.doChnk?u():l()}},fail:function(d){a.pBar.msg(this.responseText,!0)}};a.abort=function(d){a.xhr?(d=a.xhr.readyState,4>d&&0!==d?a.xhr.abort():z.abrt()):(a.pBar.remove(),a.pBar=null)};a.pBar=new R(a,a.doChnk?"chnkpb":"normpb");b="";if(a.fType.match(/image\/|video\//))if("object"==typeof K&&K.length){var P=a.fileName.split(".");if(1==P.length||0>K.indexOf(P.pop().toLowerCase()))b="<i class=\"fa fa-info-circle infoG\" onclick=\"alert('Allowed file types: ' + H5uOpts.allowed_file_types.join(', '));\"></i> File type not allowed"}else a.size>
e.maxfilesize&&(b="File is larger than allowed");else b="File type is not allowed";if(b)a.pBar.msg(b,!0),y(a.size),a.xhr=null,w(!0,"errM");else return a.xhr.onreadystatechange=z.chng,a.xhr.upload.onerror=z.fail,a.xhr.upload.onprogress=z.prog,a.doChnk?u():l(),this}var e=Object.assign({},{lodrdiv:"uplodr",upURL:"upload.php",payload:function(){return{}},maxFilesize:134217728,dropMessage:"Drop files here to upload<br>(or click to select)",concurrent:3,maxchunksize:16777216,allowed_file_types:[],success:function(b){},
doneFunc:function(b,a){}},A),J,I,v,h=[],x=e.concurrent,K=e.allowed_file_types,N=e.maxchunksize,q=!1,r=0,E=0,F=0,D=0,G=0,H=0,p,t,O="";f.H5uSetup=function(b){e=Object.assign({},e,b);b=$id(e.lodrdiv);f.File&&f.FileList?(b.appendChild(m("div",'<input type="file" name="userpictures" id="file_field" multiple="multiple" accept="image/*,video/*" style="display:none"><div class="drpmsg">'+e.dropMessage+"</div>",{id:"dropArea",onclick:"$id('file_field').click();"})),b.appendChild(m("div",'<div id="progress_report_name"></div><div id="progress_report_status" style="font-style: italic;"></div><div id="totprogress"><div id="progress_report_bar"></div></div><div>Files queued: <span id="qcount">0</span><div class="acti" id="qstop"><i class="fa fa-pause-circle pausQ" title="stop queue" onclick="H5uQctrl.stop()"></i></div><div class="acti" id="qgocan"><i class="fa fa-play-circle playQ" title="resume queue" onclick="H5uQctrl.go()"></i><i class="fa fa-times cancelQ" title="cancel queue" alt="" onclick="H5uQctrl.cancel()"></i></div></div><div id="fprogress"></div><div id="server_response"></div>',
{id:"progress_report",style:"position:relative"})),v=$id("qcount"),p=$id("qstop"),t=$id("qgocan"),$ae($id("file_field"),"change",C),(new XMLHttpRequest).upload&&(b=$id("dropArea"),$ae(b,"dragover",B),$ae(b,"dragleave",B),$ae(b,"drop",C),b.style.display="block",J=$id("progress_report_bar"),I=$id("fprogress")),"undefined"!==typeof Blob&&(O=Blob.prototype.slice?"slice":Blob.prototype.webkitSlice?"webkitSlice":Blob.prototype.mozSlice?"mozSlice":"")):b.appendChild(m("div","Can not use this upload method with the web browser that you are using.",
{}))};f.H5uQctrl={stop:function(){q=!0;p.style.display="none";t.style.display="inline-block"},go:function(){q=!1;p.style.display="inline-block";for(t.style.display="none";h.length&&r<x;)w(!1,"go")},cancel:function(){h.length=0;q=!1;t.style.display="none";v.innerHTML=0;r||M()}};f.H5uOpts=e;f.fupQadd2=C})(window,[],Joomla.getOptions("H5uOpts"));